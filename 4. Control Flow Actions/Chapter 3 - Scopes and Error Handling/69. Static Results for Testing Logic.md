# Power Automate Interview Prep Template

## Topic: 69. Static Results for Testing Logic

**Last Updated:** 2024-05-24  
**Confidence:** ðŸŸ¢ Solid  
**Category:** [Actions | Patterns | Architecture]

## What Is It?

Static Results (often referred to as "Mocking") is a feature in Power Automate that allows a developer to intercept an action's execution and return a predefined, hard-coded response instead of calling the actual underlying service or connector.

**Why It Matters:**  
It enables "Shift-Left" testing by allowing developers to verify flow logic, branching conditions, and error-handling routines without relying on external system availability, incurring API costs, or triggering irreversible side effects (like sending real emails or deleting production records).

## Core Concepts

- **Mocking (Static Result):** The process of simulating a connector's output. When enabled, the action does not execute its real-world task but immediately returns the user-defined JSON payload.
- **Status Codes:** The simulated HTTP response status (e.g., `Succeeded`, `Failed`) that determines which path the flow follows based on "Configure Run After" settings.
- **Output Schema:** The structure of the mock data. To be effective, the static JSON must match the schema expected by downstream actions to avoid runtime type-mismatch errors.

## Implementation

### Basic Setup

**Static Result Configuration:**

To enable this, click the ellipsis (...) on an action and select **Static Result (Preview)**.

```json
{
  "outputs": {
    "statusCode": "OK",
    "headers": {
      "Content-Type": "application/json"
    },
    "body": {
      "UserEmail": "test.user@example.com",
      "IsActive": true,
      "Department": "Engineering"
    }
  }
}
```

> [!TIP]
> When setting up a Static Result, first run the flow once successfully without it. Copy the "Outputs" from the run history and paste them into the Static Result configuration to ensure your mock data perfectly matches the real schema.

### Advanced Configuration

Testing failure paths requires configuring the "Status" to something other than "Succeeded" and defining an error code.

```javascript
// Example of a mocked "Failed" response to test a Catch block
{
  "status": "Failed",
  "error": {
    "code": "ServiceUnavailable",
    "message": "The server is currently overloaded. Please try again later."
  }
}
```

> [!WARNING]
> Static Results are a design-time setting. If you export a solution or move a flow to production with Static Results enabled, the action will **never** execute the real logic in the target environment. Always disable them before deployment.

## Common Patterns

### Pattern 1: The "Safety Net" Pattern

```
[Trigger] -> [Delete Row (Static Result: Enabled)] -> [Update Audit Log]
```

Used during development when you need to test the logic following a destructive action (like Delete or Update) without actually modifying or losing data in your development database.

### Pattern 2: The "Chaos Monkey" (Error Handling) Pattern

```
[HTTP Request] -> [Condition: If Success]
               -> [Scope: Catch (Run After: Has Failed)]
```

By forcing the `HTTP Request` action to return a `404 Not Found` or `500 Internal Server Error` via Static Results, you can verify that your "Catch" scope or error-notification logic works exactly as intended without needing to actually break the external API.

## Performance & Limits

> [!IMPORTANT]
> **Feature Constraints:**
> - **Availability:** Not all connectors support Static Results (though most standard and many premium ones do).
> - **Scope:** Static Results apply to the specific action instance, not the connector globally.
> - **Dynamic Content:** You cannot use dynamic expressions inside a Static Result definition; the values must be truly static.

**Optimization Tips:**
- Use Static Results to bypass long-running operations (like "Start and wait for an approval") during logic testing to speed up the inner loop of development.
- Use them to simulate "Empty Sets" (e.g., a SQL "Get Rows" returning `[]`) to ensure your flow handles null or empty arrays gracefully.
- Combine with **Scopes** to isolate specific logic blocks for unit testing.

**When NOT to use:**
- Do not use for Integration Testing where the goal is to verify the connection between systems.
- Do not use when the downstream logic depends on a value that must be calculated dynamically during the test run.

## Interview Questions

### Beginner

**Q:** What happens to the actual service call when "Static Result" is enabled on an action?

<details>
<summary>Answer</summary>

The actual service call is **bypassed entirely**. Power Automate does not attempt to connect to the external system or execute the action's logic. Instead, the workflow engine immediately returns the pre-configured static output and moves to the next step.

</details>

---

### Intermediate

**Q:** How would you use Static Results to test a flow's behavior when a specific API returns a "429 Too Many Requests" error?

<details>
<summary>Approach</summary>

**Solution:**
1. Open the action's **Static Result** settings.
2. Toggle "Enable Static Result" to **On**.
3. Set the **Status** to "Failed".
4. Enter `429` in the **Error Code** field.
5. Ensure the subsequent action in the flow is configured via **"Configure Run After"** to run when the previous action has "Failed".

> [!TIP]
> This is the only reliable way to test "Retry Policy" logic without actually flooding a service with requests.

**Follow-up they'll ask:** "Can you mock the headers in a Static Result?"  
**Answer:** Yes, the configuration allows you to specify custom headers, which is useful if your flow logic depends on specific header values like `Retry-After`.

</details>

---

### Advanced

**Q:** You are building a complex flow in a multi-environment ALM (Dev -> Test -> Prod) pipeline. What are the risks associated with Static Results, and how do you mitigate them?

<details>
<summary>Solution</summary>

**Architecture:**
Static Results are stored within the flow definition (JSON).

**Key considerations:**
The primary risk is **accidental deployment**. If a developer forgets to disable a Static Result, the flow will appear to work in Production but will be using fake data, potentially leading to data integrity issues or "silent" failures where real actions aren't happening.

**Trade-offs to discuss:**
- **Manual Check:** Simple but error-prone.
- **Environment Variables:** While you can't put an environment variable *inside* the Static Result toggle, you can use a **Condition** action that checks an "IsTestMode" environment variable. If true, it goes to an action with Static Results; if false, it goes to the real action.
- **Solution Checker:** Use the Power Platform Solution Checker to identify flows that might have preview features or specific configurations enabled before promotion.

</details>

## Real Example

> [!NOTE]
> **Problem:** A flow processing high-value invoices was failing on a specific "Currency Conversion" step, but the error only occurred once every 1,000 runs due to an external API timeout.  
> **Solution:** The developer enabled Static Results on the Currency Conversion action and simulated a "Timed Out" error. This allowed them to build and test a "Do Until" loop with a back-off strategy.  
> **Result:** The flow became resilient to API instability, reducing manual intervention by 95%.

## Quick Reference

### Common Mock Status Codes

| Status | Use Case |
|--------|----------|
| **Succeeded** | Standard path testing. |
| **Failed** | Testing error handling/Catch blocks. |
| **TimedOut** | Testing timeout logic and retries. |
| **Skipped** | Simulating conditional logic bypass. |

## Practice

**Exercise 1:** Create a flow that triggers on a button press, calls "Get Manager (V2)", and then sends an email. Use Static Results to simulate a scenario where the user has no manager.

<details>
<summary>Hint</summary>

Enable Static Result on the "Get Manager" action. Set the status to "Failed" with a code of "NotFound". Then, use "Configure Run After" on the Email action to handle the failure.

</details>

<details>
<summary>Solution</summary>

1. Add **Get Manager (V2)** action.
2. Ellipsis (...) -> **Static Result**.
3. Toggle **On**.
4. Status: **Failed**.
5. Error Code: **404**.
6. Add an **Office 365 Outlook - Send an email** action.
7. Set "Configure Run After" for the email action to **"has failed"**.
8. In the email body, write: "Manager not found, routing to HR."

**Key points:**
This ensures the flow doesn't just crash when a manager is missing, but follows a defined fallback path.
</details>

## Troubleshooting Guide

> [!CAUTION]
> **Common Errors:**

| Error | Cause | Fix |
|-------|-------|-----|
| **InvalidTemplate** | The JSON body in the Static Result does not match the expected schema. | Copy the body from a successful run's output and paste it into the Static Result. |
| **ActionNotExecuted** | The action is returning mock data in Production. | Disable Static Result in the flow designer and re-publish/re-import the solution. |
| **Missing Dynamic Content** | Downstream actions can't see fields from the Static Result. | Ensure the JSON keys in your Static Result match the internal names of the connector's output fields. |

## Tags
#testing #debugging #static-results #mocking #error-handling #best-practices