# 29. Scheduled Triggers Overview

Canonical documentation for 29. Scheduled Triggers Overview. This document defines concepts, terminology, and standard usage.

## Purpose
Scheduled Triggers serve as the temporal orchestration layer for automated systems. They address the requirement for non-interactive, time-based execution of logic, allowing systems to perform maintenance, generate reports, synchronize data, and manage state transitions without external stimulus or manual intervention. By decoupling execution from immediate user action, Scheduled Triggers enable predictable, asynchronous operations within a distributed or monolithic architecture.

> [!NOTE]
> This documentation is intended to be implementation-agnostic and authoritative.

## Scope
Clarify what is in scope and out of scope for this topic.

**In scope:**
* Core mechanisms of time-based invocation.
* Theoretical models for scheduling (CRON, Intervals, One-time).
* Precision, reliability, and state management of temporal triggers.
* Architectural patterns for handling scheduled workloads.

**Out of scope:**
* Specific syntax for vendor-specific CRON implementations (e.g., AWS EventBridge vs. Linux crontab).
* Implementation details of specific job queues or message brokers.
* UI/UX design for scheduling interfaces.

## Definitions
Provide precise definitions for key terms.

| Term | Definition |
|------|------------|
| **Trigger** | A mechanism that initiates the execution of a predefined action or process. |
| **Schedule Expression** | A string or object representing the temporal rules for execution (e.g., CRON expression or ISO 8601 duration). |
| **Interval** | A fixed duration of time between the start (or end) of successive executions. |
| **Idempotency** | The property of a process where multiple identical executions have the same effect as a single execution. |
| **Jitter** | The intentional introduction of random delay to prevent synchronized "thundering herd" spikes in resource demand. |
| **Misfire** | A scenario where a scheduled trigger fails to execute at its designated time due to system downtime or resource exhaustion. |
| **Backfill** | The process of executing missed occurrences of a scheduled task after a period of system unavailability. |
| **Drift** | The cumulative divergence between the intended execution time and the actual execution time. |

## Core Concepts

### 1. Temporal Determinism
Scheduled triggers rely on a shared understanding of time. Systems must define a "Source of Truth" for time (usually UTC) to ensure that triggers fire consistently regardless of the physical location of the compute resources.

### 2. Trigger Types
*   **Recurring (CRON):** Triggers based on calendar-based patterns (e.g., "Every Monday at 08:00").
*   **Fixed Interval:** Triggers based on elapsed time since the last execution (e.g., "Every 5 minutes").
*   **One-Time (Ad-hoc):** A trigger scheduled for a specific, single point in the future.

### 3. Precision vs. Accuracy
*   **Precision** refers to the granularity of the scheduler (e.g., second-level vs. minute-level).
*   **Accuracy** refers to how close the actual execution time is to the scheduled time. In distributed systems, "perfect" accuracy is rarely guaranteed due to network latency and scheduling overhead.

## Standard Model
The standard model for Scheduled Triggers involves three distinct components:

1.  **The Scheduler (Control Plane):** Monitors the clock and the registry of defined schedules. When a temporal condition is met, it emits an execution signal.
2.  **The Trigger Registry (Persistence):** A data store containing the metadata for all schedules, including their expressions, last run times, and target references.
3.  **The Executor (Data Plane):** The compute environment that receives the signal and performs the actual work. 

In this model, the Scheduler should be decoupled from the Executor to ensure that long-running tasks do not block the Scheduler from firing subsequent triggers.

## Common Patterns

### Singleton Execution
Ensures that only one instance of a scheduled task is running at any given time. If a new trigger fires while the previous execution is still active, the new execution is either skipped or queued.

### Fan-Out
A single scheduled trigger initiates a coordinator task, which then distributes work across multiple parallel workers. This is common for bulk data processing or mass notifications.

### Self-Correcting Schedules (Backfilling)
A pattern where the system detects missed executions (due to downtime) and automatically triggers them in sequence to ensure data integrity and continuity.

### Jitter Injection
In high-scale environments, adding a small, random offset to the scheduled time prevents thousands of instances from hitting a shared resource (like a database) at the exact same millisecond.

## Anti-Patterns

### Hardcoding Timezones
Relying on local server time instead of UTC. This leads to catastrophic failures or double-executions during Daylight Saving Time (DST) transitions.

### Overlapping Executions without Locking
Scheduling a task to run every minute when the task takes two minutes to complete, without implementing concurrency controls. This leads to resource exhaustion and race conditions.

### Heavy Logic in the Scheduler
Performing actual business logic within the scheduling service itself. The scheduler should only be responsible for dispatching signals.

### Tight Coupling to Compute
Assuming the trigger and the execution will happen on the same physical machine. This prevents horizontal scaling and reduces fault tolerance.

## Edge Cases

### Daylight Saving Time (DST)
When clocks move forward or backward, triggers scheduled during the "missing" or "repeated" hour may fire twice or not at all. Canonical systems should use UTC to avoid this, or define specific behavior for "Wall Clock" scheduling.

### Leap Seconds and Leap Years
While rare, triggers scheduled for February 29th or during leap second adjustments must be handled by the underlying temporal engine to avoid logic errors.

### System Downtime
If the scheduler is offline for 10 minutes, the system must have a policy for the triggers that should have fired during that window:
*   **Ignore:** Skip all missed fires.
*   **Fire Once:** Execute the task once, regardless of how many fires were missed.
*   **Catch Up:** Execute the task for every missed interval.

### Thundering Herds
When a large number of independent triggers are scheduled for the same "round" time (e.g., midnight), causing a massive spike in infrastructure load.

## Related Topics
*   **28. Event-Driven Architecture:** Contrast between time-based and event-based invocation.
*   **30. Idempotency Patterns:** Essential for ensuring safe retries of scheduled tasks.
*   **45. Distributed Locking:** Mechanisms to prevent overlapping executions.
*   **12. Temporal Data Modeling:** How to store and query time-series data related to triggers.

## Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-16 | Initial AI-generated canonical documentation |