# 43. Update a Row Excel

Canonical documentation for 43. Update a Row Excel. This document defines concepts, terminology, and standard usage.

## Purpose
The "Update a Row" operation exists to facilitate the modification of existing data within a structured spreadsheet environment. It addresses the need for data persistence and synchronization where a specific record—represented horizontally as a row—must be altered to reflect a new state, corrected information, or calculated results without affecting the surrounding data structure or the integrity of the worksheet.

> [!NOTE]
> This documentation is intended to be implementation-agnostic and authoritative.

## Scope
Clarify what is in scope and out of scope for this topic.

**In scope:**
* **Targeting Mechanisms:** Methods for identifying the specific row to be modified.
* **Data Mutation:** The logic of replacing or merging cell values within a row.
* **Data Integrity:** Maintaining the structural consistency of the spreadsheet during an update.
* **State Management:** Handling the transition from the "Old" state to the "New" state of a record.

**Out of scope:**
* **Vendor-specific APIs:** Specific syntax for Microsoft Graph, Google Sheets API, or library-specific functions (e.g., `pandas`, `openpyxl`).
* **Row Creation/Deletion:** The processes of appending new records or removing existing ones.
* **Formatting:** Visual styling (colors, fonts) of the row, unless the format conveys data meaning.

## Definitions
Provide precise definitions for key terms.

| Term | Definition |
|------|------------|
| **Row** | A horizontal sequence of cells in a worksheet, typically representing a single record or object instance. |
| **Key/Identifier** | A unique value within a specific column used to distinguish one row from another (e.g., an ID or Email). |
| **Index** | The numerical position of a row within a worksheet (e.g., Row 5). |
| **Partial Update** | An operation that modifies only specific cells within a row while leaving others untouched. |
| **Full Update** | An operation that replaces the entire content of a row with a new data set. |
| **Worksheet/Table** | The container or grid structure where rows reside. |

## Core Concepts
### Row Identification
Before an update can occur, the system must resolve the target row. This is achieved through two primary methods:
1.  **Positional Addressing:** Using the absolute or relative index (e.g., "Update the 10th row").
2.  **Logical Addressing:** Searching for a row where a specific column matches a unique identifier (e.g., "Update the row where 'EmployeeID' is 501").

### Data Merging Logic
Updates generally follow one of two logic paths:
*   **Overwrite:** The new data payload completely replaces the existing row data.
*   **Patch/Merge:** The system compares the new data with the existing data and only updates the fields provided in the request, preserving existing data in omitted fields.

### Schema Adherence
Updating a row requires the new data to conform to the existing schema of the worksheet (e.g., data types, column order, and constraints) to prevent data corruption.

## Standard Model
The standard model for updating a row follows a four-step lifecycle:

1.  **Locate:** The system identifies the target row based on a provided key or index.
2.  **Validate:** The system ensures the row exists and that the new data meets the worksheet's validation rules (e.g., no text in a date column).
3.  **Transform:** The system maps the input data to the corresponding columns in the target row.
4.  **Commit:** The changes are written to the persistent storage of the spreadsheet file.

## Common Patterns
*   **Lookup-and-Update:** The most common pattern where a unique ID is used to find a row, followed by a modification of its attributes.
*   **Batch Update:** Updating multiple rows in a single transaction to optimize performance and ensure atomicity.
*   **Conditional Update:** Updating a row only if certain criteria are met (e.g., "Update status to 'Complete' only if current status is 'In Progress'").
*   **Upsert (Update or Insert):** A hybrid pattern where the system attempts to update a row if it exists, but creates a new one if the identifier is not found.

## Anti-Patterns
*   **Hard-coded Indexing:** Relying on a fixed row number (e.g., "Row 2") in a dynamic environment where rows may be sorted, filtered, or inserted.
*   **Header Overwriting:** Failing to account for the header row, resulting in the accidental modification of column labels.
*   **Blind Updates:** Overwriting a row without first verifying its current state, which can lead to "lost updates" in multi-user environments.
*   **Data Type Mismatch:** Injecting string data into columns intended for numerical calculations, breaking downstream formulas.

## Edge Cases
*   **Duplicate Keys:** If a worksheet contains multiple rows with the same "unique" identifier, the system must define whether to update the first match, all matches, or throw an error.
*   **Hidden or Filtered Rows:** Determining if an update should apply to rows that are currently hidden from the user's view.
*   **Merged Cells:** Updating a row that contains merged cells, which can disrupt the expected column-to-index mapping.
*   **Formula-Driven Cells:** Attempting to update a cell that contains a formula; standard behavior usually involves overwriting the formula with a static value, which may be unintended.
*   **Concurrent Access:** Two processes attempting to update the same row simultaneously.

## Related Topics
*   **42. Search for a Row:** The prerequisite operation for logical addressing.
*   **44. Delete a Row:** The destructive counterpart to the update operation.
*   **Data Validation:** The ruleset that governs what data is permissible during an update.
*   **Table Objects:** Structured ranges that provide more robust update capabilities than raw worksheets.

## Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-16 | Initial AI-generated canonical documentation |