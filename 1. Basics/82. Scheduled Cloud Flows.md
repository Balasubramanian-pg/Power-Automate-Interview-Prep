# 82. Scheduled Cloud Flows

Canonical documentation for 82. Scheduled Cloud Flows. This document defines concepts, terminology, and standard usage.

## Purpose
Scheduled Cloud Flows address the requirement for temporal automation within distributed systems. They exist to decouple process execution from immediate human intervention or external event triggers, allowing logic to run at predefined intervals or specific timestamps. This capability is essential for routine maintenance, periodic data synchronization, batch processing, and the generation of recurring reports.

By providing a mechanism for time-based orchestration, Scheduled Cloud Flows ensure that business logic is applied consistently across datasets without requiring an external "push" from a source system.

> [!NOTE]
> This documentation is intended to be implementation-agnostic and authoritative.

## Scope
**In scope:**
* **Temporal Triggers:** Mechanisms that initiate logic based on time, frequency, and recurrence patterns.
* **State Management:** The theoretical handling of data between scheduled runs.
* **Execution Windows:** The boundaries and constraints of time-based processing.
* **Orchestration Logic:** The flow of operations following a temporal trigger.

**Out of scope:**
* **Event-Driven Triggers:** Logic initiated by data changes (e.g., Webhooks, Polling for changes).
* **Manual Triggers:** Logic initiated by direct user action.
* **Vendor-Specific Syntax:** Specific expressions used by individual cloud providers (e.g., CRON syntax vs. UI-based builders).

## Definitions
| Term | Definition |
|------|------------|
| **Recurrence** | The pattern defining how often a flow repeats (e.g., daily, weekly). |
| **Interval** | The numerical value representing the gap between executions (e.g., every *3* hours). |
| **Frequency** | The unit of time used for the interval (e.g., Minute, Hour, Day, Month). |
| **Start Time** | The specific ISO 8601 timestamp marking the first intended execution. |
| **Drift** | The cumulative lag between the intended execution time and the actual execution time. |
| **Idempotency** | The property of a flow where multiple executions produce the same result without unintended side effects. |
| **Backfill** | The process of running missed executions caused by system downtime or late configuration. |

## Core Concepts

### 1. Temporal Decoupling
Scheduled flows operate independently of the systems they interact with. Unlike event-driven flows, which require a source system to "announce" a change, a scheduled flow assumes the responsibility of checking state or performing actions at a specific point in time.

### 2. Deterministic Scheduling
A scheduled flow relies on a deterministic clock. The execution is predictable and can be mapped on a calendar. This allows for resource planning and ensures that high-compute tasks are offloaded to non-peak hours.

### 3. Statelessness vs. Persistence
While the trigger itself is stateless (it only knows "it is now time to run"), the logic within the flow often requires persistence. Scheduled flows frequently use a "watermark" (a stored timestamp of the last successful run) to determine which records to process in the current window.

## Standard Model
The standard model for a Scheduled Cloud Flow follows a four-phase lifecycle:

1.  **The Trigger Phase:** The scheduler identifies that the current system time matches the defined recurrence pattern and initiates the flow instance.
2.  **The Scope Definition Phase:** The flow queries or calculates the boundaries of the data it must act upon (e.g., "Find all records modified in the last 24 hours").
3.  **The Execution Phase:** The flow performs the core logic (transformation, notification, or integration) on the identified scope.
4.  **The Finalization Phase:** The flow updates its own internal state or logs the completion status to prevent duplicate processing in the next cycle.

## Common Patterns

### The Janitor (Cleanup)
A flow that runs during low-traffic periods to delete temporary files, archive old logs, or clear expired cache entries.

### The Aggregator (Reporting)
A flow that collects data from multiple sources over a specific period (e.g., the previous day) and generates a summary report or dashboard update.

### The Synchronizer (Batch ETL)
A flow that moves data between two systems where real-time integration is either impossible or inefficient. It typically uses a "delta-load" approach, only moving records changed since the last scheduled run.

### The Heartbeat (Monitoring)
A flow that runs at high frequency (e.g., every 5 minutes) to check the availability of a service and alert administrators if the service is unreachable.

## Anti-Patterns

### Over-Scheduling (Aggressive Polling)
Setting a recurrence interval that is shorter than the average execution time of the flow. This leads to "run overlap," where multiple instances of the same flow compete for the same resources or create race conditions.

### Lack of Idempotency
Designing a flow that performs the same action multiple times if re-run. For example, a scheduled flow that sends an invoice should check if the invoice was already sent to avoid spamming the recipient in case of a flow restart.

### Hard-Coded Time Zones
Failing to account for Coordinated Universal Time (UTC) or Daylight Savings Time (DST). This can cause flows to run an hour early or late twice a year, or at incorrect times for global teams.

### Monolithic Processing
Attempting to process millions of records in a single scheduled run. This often leads to timeouts. The preferred approach is to use the scheduled flow to trigger smaller, parallelized sub-processes.

## Edge Cases

### Daylight Savings Time (DST) Transitions
When a clock shifts forward or backward, a flow scheduled at 02:00 AM may run twice or not at all, depending on the underlying scheduler's logic. Canonical designs use UTC to avoid this ambiguity.

### Leap Years and Month-Ends
Flows scheduled for the "31st of the month" will not run in months with fewer days unless the scheduler supports "Last Day of Month" logic.

### System Downtime
If the cloud provider's scheduling engine is offline during the scheduled start time, the flow may either skip the run entirely or "fire" immediately upon system restoration (Backfilling). Documentation must define the expected behavior for critical processes.

### Overlapping Executions
If "Run A" is still processing when "Run B" is triggered, the system must decide whether to allow concurrency, queue "Run B," or cancel "Run B."

## Related Topics
* **81. Event-Driven Orchestration:** The counterpart to scheduled flows, triggered by state changes.
* **Batch Processing Patterns:** Techniques for handling large volumes of data within a single execution window.
* **Error Handling and Retry Policies:** How scheduled flows recover from transient failures.
* **ISO 8601 Standards:** The international standard for representing dates and times.

## Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-16 | Initial AI-generated canonical documentation |