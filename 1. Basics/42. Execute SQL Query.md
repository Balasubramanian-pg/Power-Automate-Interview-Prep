# 42. Execute SQL Query

Canonical documentation for 42. Execute SQL Query. This document defines concepts, terminology, and standard usage.

## Purpose
The "Execute SQL Query" operation serves as the primary interface between an application or user and a Relational Database Management System (RDBMS). Its purpose is to facilitate the retrieval, insertion, modification, or deletion of data, as well as the management of database schemas. This operation abstracts the underlying storage mechanics, allowing for declarative data manipulation through Structured Query Language (SQL).

> [!NOTE]
> This documentation is intended to be implementation-agnostic and authoritative. It focuses on the logical execution of SQL rather than the specific syntax of individual database engines.

## Scope
Clarify what is in scope and out of scope for this topic.

**In scope:**
* The lifecycle of a SQL execution request.
* Interaction patterns between the client and the database engine.
* Standardized input/output structures (Parameters and Result Sets).
* Transactional boundaries and execution contexts.

**Out of scope:**
* Specific dialect syntax (e.g., T-SQL vs. PL/SQL).
* Physical storage optimization (e.g., disk I/O, indexing strategies).
* Driver-specific implementation details (e.g., JDBC vs. ODBC internals).

## Definitions
Provide precise definitions for key terms.

| Term | Definition |
|------|------------|
| **SQL Statement** | A string of text conforming to SQL syntax rules that describes a desired database operation. |
| **Connection** | A stateful session established between a client and a database server. |
| **Result Set** | A tabular data structure returned by a query, consisting of rows and columns. |
| **Parameterized Query** | A query template where placeholders are used for data values to separate code from data. |
| **Execution Plan** | The internal roadmap generated by the database engine to determine the most efficient way to fulfill a query. |
| **Affected Rows** | The count of records modified, inserted, or deleted by a Non-Query execution. |
| **Transaction** | A logical unit of work that must be completed in its entirety to maintain data integrity. |

## Core Concepts
### The Execution Lifecycle
The execution of a SQL query typically follows a four-stage lifecycle:
1.  **Parsing:** The database engine validates the syntax and checks the query against the system catalog (permissions, table existence).
2.  **Optimization:** The engine evaluates multiple paths to retrieve or modify data and selects the most efficient Execution Plan.
3.  **Execution:** The engine performs the physical operations (reads/writes) defined in the plan.
4.  **Result Processing:** The engine packages the outcome—either a Result Set or a status message—and transmits it back to the requester.

### Synchronous vs. Asynchronous Execution
*   **Synchronous:** The calling process blocks and waits for the database to return the result.
*   **Asynchronous:** The calling process initiates the execution and continues other work, receiving a notification or polling for the result later.

## Standard Model
The standard model for executing a SQL query involves a **Request-Response** pattern within a managed **Connection Context**.

1.  **Establishment:** A connection is retrieved from a pool or newly created.
2.  **Preparation:** The SQL statement is defined. If using parameters, the statement is "prepared" to allow the engine to pre-compile the execution plan.
3.  **Binding:** Values are bound to the parameters.
4.  **Invocation:** The execution command is issued.
5.  **Consumption:** The client iterates through the Result Set or checks the success status.
6.  **Cleanup:** Resources (cursors, result sets, and sometimes connections) are explicitly closed.

## Common Patterns
### Data Retrieval (DQL)
The use of `SELECT` statements to fetch data. The output is a Result Set. This pattern often involves pagination to handle large volumes of data.

### Data Modification (DML)
The use of `INSERT`, `UPDATE`, or `DELETE` statements. The output is typically an integer representing the "Affected Rows."

### Batch Execution
Sending multiple SQL statements or a single statement with multiple sets of parameters in a single round-trip to reduce network latency.

### Schema Management (DDL)
The use of `CREATE`, `ALTER`, or `DROP` statements to define the structure of the database. These are typically executed outside of standard application runtime flows.

## Anti-Patterns
*   **String Concatenation:** Building SQL queries by concatenating strings with user input. This leads to **SQL Injection** vulnerabilities.
*   **Over-fetching (N+1 Problem):** Executing a query inside a loop to fetch related data for each row, rather than using a single `JOIN` or `IN` clause.
*   **The "Select Star" (*):** Requesting all columns when only a subset is needed. This increases network overhead and can break applications when schema changes occur.
*   **Ignoring Timeouts:** Failing to define execution timeouts, which can lead to application-wide hangs if the database becomes unresponsive or a query is poorly optimized.

## Edge Cases
*   **Empty Result Sets:** A query that is syntactically correct but returns zero rows. Applications must distinguish between "no data found" and "execution error."
*   **Deadlocks:** When two executions wait for each other to release locks. The system must be prepared to retry the execution or fail gracefully.
*   **Large Objects (LOBs):** Executing queries that return massive binary or text data (BLOBs/CLOBs) requires streaming the result rather than loading it entirely into memory.
*   **Connection Loss During Execution:** If the network fails after the command is sent but before the result is received, the state of the data (especially in non-transactional contexts) may be indeterminate.

## Related Topics
*   **Connection Pooling:** The management of a cache of database connections.
*   **Transaction Management:** Handling ACID properties (Atomicity, Consistency, Isolation, Durability).
*   **Object-Relational Mapping (ORM):** Abstraction layers that map SQL results to object-oriented structures.
*   **Database Indexing:** The underlying structures that SQL queries utilize for performance.

## Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-16 | Initial AI-generated canonical documentation |