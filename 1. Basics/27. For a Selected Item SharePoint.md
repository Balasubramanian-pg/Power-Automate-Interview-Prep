# 27. For a Selected Item SharePoint

Canonical documentation for 27. For a Selected Item SharePoint. This document defines concepts, terminology, and standard usage.

## Purpose
The "For a Selected Item" mechanism serves as a bridge between manual data management and automated business logic. It addresses the need for **user-initiated automation** within a structured data environment. Unlike automated triggers that respond to state changes (such as creation or modification), this topic focuses on the "on-demand" execution of logic against a specific record or file, allowing human discretion to dictate when a process should begin.

> [!NOTE]
> This documentation is intended to be implementation-agnostic and authoritative. While the nomenclature is derived from specific ecosystem integrations, the principles apply to any system where a user manually invokes a workflow against a discrete data entity.

## Scope
Clarify what is in scope and out of scope for this topic.

**In scope:**
* The conceptual framework of user-initiated triggers.
* Data requirements for establishing context (ID, List, Site).
* The lifecycle of a manual invocation.
* Input parameterization at the point of trigger.

**Out of scope:**
* Specific vendor-specific workflow designers (e.g., Power Automate UI, Logic Apps Designer).
* Step-by-step "how-to" guides for specific software versions.
* General SharePoint administration not related to item-level triggers.

## Definitions
Provide precise definitions for key terms.

| Term | Definition |
|------|------------|
| **Contextual Trigger** | An automation starting point that requires a specific record's identity to execute. |
| **Input Schema** | The defined set of fields presented to a user at the moment of invocation to gather additional metadata. |
| **Invocation** | The act of a user manually starting the process from the host interface. |
| **Payload** | The data packet sent from the host system to the automation engine, containing item metadata and user inputs. |
| **Host Environment** | The interface (List or Library) where the data resides and the trigger is surfaced. |

## Core Concepts

### 1. User Intent vs. System Event
The fundamental concept is the shift from **reactive automation** (system-driven) to **proactive automation** (human-driven). This allows for business processes that require qualitative judgment—such as deciding when a document is "ready" for a formal review—rather than relying on binary data changes.

### 2. Contextual Awareness
The trigger must inherently "know" which item it is acting upon. This is achieved through the passing of a Unique Identifier (UID) and the Source Location (Site/List URL). Without this context, the automation cannot perform subsequent "Get" or "Update" actions.

### 3. Runtime Input
A core capability of this trigger type is the ability to solicit information from the user that is not stored in the record itself. This "Runtime Input" allows for dynamic processing, such as selecting an assignee or adding a custom comment that exists only for the duration of that specific execution.

## Standard Model
The standard model for a "For a Selected Item" interaction follows a linear progression:

1.  **Selection:** The user identifies one or more records in the Host Environment.
2.  **Discovery:** The Host Environment queries available manual triggers associated with that specific data schema.
3.  **Input Collection:** If the trigger defines an Input Schema, a modal or side-pane is presented to the user.
4.  **Handshake:** The Host Environment packages the Item ID, User Identity, and Input Data into a JSON payload.
5.  **Execution:** The automation engine receives the payload and initiates the defined logic.

## Common Patterns

*   **The Ad-Hoc Approval:** A user selects a document and triggers an approval process that is not part of the standard document lifecycle.
*   **Data Enrichment:** A user triggers a process to fetch data from an external API and write it back to the selected item.
*   **Document Generation:** Using the metadata of a selected list item to populate a template and generate a PDF or Word document.
*   **Status Override:** Forcing a record into a specific state (e.g., "Archived") through a manual trigger when standard business rules do not apply.

## Anti-Patterns

*   **Redundant Data Entry:** Asking the user to input data in the trigger modal that already exists in the list item columns.
*   **Bulk-Unfriendly Logic:** Designing a trigger that fails or hits rate limits when a user selects 50 items and triggers the process simultaneously.
*   **Lack of Feedback:** Failing to provide the user with a confirmation or status update within the Host Environment after the trigger is invoked.
*   **Over-Permissioning:** Allowing users to see and trigger processes for which they do not have the underlying data permissions (e.g., triggering a "Delete" process on a read-only item).

## Edge Cases

*   **Item Deletion During Execution:** If a user triggers a process and then immediately deletes the item, subsequent steps in the automation that attempt to reference the item will fail.
*   **Schema Mismatch:** If the list columns are modified after the trigger is configured, the automation may fail if it relies on deprecated internal names.
*   **Large List Throttling:** In environments with tens of thousands of items, the discovery of manual triggers can occasionally experience latency or "View Threshold" errors.
*   **Version History:** Manual triggers that update the item will create new versions; if versioning is capped, this may result in the loss of historical data.

## Related Topics
*   **28. For a Selected File (SharePoint):** The specific application of this logic to document libraries.
*   **Event-Driven Architecture:** The broader category of system-initiated triggers.
*   **Role-Based Access Control (RBAC):** Governing who can see and execute specific manual triggers.
*   **JSON Schema Validation:** The method used to define and validate runtime inputs.

## Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-16 | Initial AI-generated canonical documentation |