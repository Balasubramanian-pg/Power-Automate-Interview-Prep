# 39. Data Actions CRUD Operations

Canonical documentation for 39. Data Actions CRUD Operations. This document defines concepts, terminology, and standard usage.

## Purpose
Data Actions CRUD Operations serve as the standardized interface between business logic layers and data persistence layers. The purpose of this topic is to define the structural requirements and behavioral expectations for operations that Create, Read, Update, and Delete data within an application ecosystem. By formalizing these actions, systems achieve decoupling, allowing the user interface or orchestration layer to interact with data without requiring knowledge of the underlying storage technology or schema complexities.

> [!NOTE]
> This documentation is intended to be implementation-agnostic and authoritative.

## Scope
Clarify what is in scope and out of scope for this topic.

**In scope:**
*   The lifecycle and state transitions of CRUD-based data actions.
*   Standardized request and response structures.
*   Validation and error-handling requirements at the action level.
*   Theoretical boundaries of atomic vs. batch operations.

**Out of scope:**
*   Specific database syntax (SQL, NoSQL, GraphQL).
*   Vendor-specific API implementations (e.g., AWS Lambda, Salesforce Apex, Azure Functions).
*   Network-level protocols (HTTP, gRPC, WebSockets).

## Definitions
Provide precise definitions for key terms.

| Term | Definition |
|------|------------|
| **Data Action** | A discrete, encapsulated unit of logic designed to perform a specific operation on a data source. |
| **Payload** | The structured data sent to an action to facilitate a Create or Update operation. |
| **Idempotency** | The property of certain operations where multiple identical requests have the same effect as a single request. |
| **Soft Delete** | A pattern where a record is marked as inactive or hidden rather than being physically removed from storage. |
| **Partial Update** | An operation that modifies only specific fields of a record rather than replacing the entire entity. |
| **Schema** | The structural definition that a Data Action must adhere to for both input and output. |
| **Atomic Operation** | An operation that either completes entirely or fails entirely, leaving the system state consistent. |

## Core Concepts

### 1. The CRUD Abstraction
Data Actions abstract the complexity of data persistence. Instead of the application logic interacting directly with a database, it invokes a "Data Action." This ensures that business rules (such as "only an admin can delete") can be enforced consistently regardless of where the action is triggered.

### 2. Statelessness
Standard Data Actions should be stateless. Each invocation must contain all the necessary context (authentication tokens, identifiers, and payloads) to complete the operation without relying on the state of previous calls.

### 3. Input/Output Contract
Every Data Action must adhere to a strict contract:
*   **Input:** A defined set of parameters or a structured object.
*   **Output:** A predictable response containing the result of the operation (the data affected) and a status indicator (success/failure).

## Standard Model

The standard model for Data Actions CRUD Operations follows a request-response lifecycle:

1.  **Initialization:** The action is invoked with a specific payload and context.
2.  **Validation:** The system verifies that the input meets schema requirements and that the requester has sufficient permissions.
3.  **Execution:**
    *   **Create:** Generates a new unique identifier and persists the provided data.
    *   **Read:** Retrieves data based on filters or unique identifiers.
    *   **Update:** Modifies existing data based on a unique identifier.
    *   **Delete:** Removes or deactivates data based on a unique identifier.
4.  **Transformation:** The raw data from the storage layer is mapped back to the standardized output schema.
5.  **Finalization:** The action returns a response object containing the status and the resulting data.

## Common Patterns

### Optimistic Concurrency
In Update operations, the action checks a version number or timestamp to ensure the data hasn't changed since the user last read it, preventing "lost updates."

### Upsert (Update or Insert)
A hybrid pattern where the action attempts to update a record if it exists, or creates a new one if it does not, typically based on a unique key.

### Pagination and Filtering
For Read operations involving collections, standard patterns include limit/offset or cursor-based navigation to manage large datasets efficiently.

### Soft Delete vs. Hard Delete
*   **Soft Delete:** Updates a `deleted_at` or `is_active` flag.
*   **Hard Delete:** Permanently removes the record from the physical medium.

## Anti-Patterns

*   **The God Action:** Creating a single Data Action that handles all four CRUD operations through complex conditional logic, leading to maintenance difficulties.
*   **Side-Effect Reads:** Designing a Read action that modifies data (e.g., updating a "last viewed" timestamp) without explicit intent, violating the principle of "Safe" operations.
*   **Leaky Abstractions:** Returning raw database error messages or internal IDs directly to the client, exposing the underlying implementation details.
*   **Ignoring Return Values:** Executing a Create or Update action without returning the modified object, forcing the client to perform a subsequent Read operation.

## Edge Cases

*   **Partial Success in Batch Operations:** When performing CRUD on multiple records, a scenario where some succeed and others fail requires a standardized "Partial Success" response and rollback strategy.
*   **Race Conditions:** Multiple Update actions targeting the same record simultaneously.
*   **Orphaned Records:** Deleting a parent record without a strategy for child records (Cascade Delete vs. Restrict).
*   **Empty Payloads:** Handling Update requests where no fields are provided (should result in a "No Content" or "No Change" status rather than an error).

## Related Topics
*   **Data Validation and Sanitization:** The process of ensuring input data is safe and valid.
*   **Authentication and Authorization:** Determining who can execute specific Data Actions.
*   **Transaction Management:** Handling multi-step Data Actions that must succeed or fail as a unit.
*   **Event-Driven Architecture:** Triggering secondary actions based on the completion of a CRUD operation.

## Change Log

| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-16 | Initial AI-generated canonical documentation |