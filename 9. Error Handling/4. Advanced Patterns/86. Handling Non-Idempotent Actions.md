# 86. Handling Non-Idempotent Actions

Canonical documentation for 86. Handling Non-Idempotent Actions. This document defines the conceptual model, terminology, and standard usage patterns.

> [!NOTE]
> This documentation is implementation-agnostic and intended to serve as a stable reference.

## 1. Purpose and Problem Space
Describe why 86. Handling Non-Idempotent Actions exists and the class of problems it addresses.
The purpose of handling non-idempotent actions is to manage and mitigate the effects of operations that produce different outcomes when repeated. Non-idempotent actions can lead to inconsistencies, data corruption, and unintended side effects, making it challenging to maintain a reliable and predictable system. This documentation addresses the class of problems related to ensuring the integrity and consistency of systems in the presence of non-idempotent operations.

## 2. Conceptual Overview
Provide a high-level mental model of the topic.
Handling non-idempotent actions involves understanding the nature of idempotence, identifying non-idempotent operations, and implementing strategies to manage their effects. Idempotence refers to the property of an operation that produces the same outcome regardless of the number of times it is applied. Non-idempotent actions, on the other hand, produce different outcomes when repeated. The conceptual model for handling non-idempotent actions includes recognizing the sources of non-idempotence, such as concurrent modifications, and applying techniques like token-based synchronization, versioning, or transactional approaches to mitigate their impact.

## 3. Terminology and Definitions
| Term | Definition |
|------|------------|
| Idempotence | The property of an operation that produces the same outcome regardless of the number of times it is applied. |
| Non-Idempotent Action | An operation that produces different outcomes when repeated. |
| Token-Based Synchronization | A technique using tokens to synchronize access to shared resources and prevent concurrent modifications. |
| Versioning | A strategy that involves tracking changes to data or resources to ensure consistency and detect conflicts. |
| Transactional Approach | A method that treats a sequence of operations as a single, all-or-nothing unit of work to maintain consistency and integrity. |

## 4. Core Concepts
Explain the fundamental ideas that form the basis of this topic.
The core concepts of handling non-idempotent actions include:
- **Idempotence**: Understanding the property of idempotence and its implications for system design and operation.
- **Non-Idempotent Actions**: Recognizing the sources and characteristics of non-idempotent operations.
- **Concurrency Control**: Implementing mechanisms to manage concurrent access to shared resources and prevent conflicts.
- **Error Handling**: Developing strategies to detect, report, and recover from errors resulting from non-idempotent actions.

## 5. Standard Model
Describe the generally accepted or recommended model.
The standard model for handling non-idempotent actions involves a combination of design principles and implementation strategies, including:
- Designing idempotent interfaces wherever possible.
- Implementing concurrency control mechanisms, such as locks or transactions.
- Using versioning or token-based synchronization for shared resources.
- Developing robust error handling and recovery mechanisms.

## 6. Common Patterns
Document recurring, accepted patterns.
Common patterns for handling non-idempotent actions include:
- **Retry Mechanisms**: Implementing retry logic with exponential backoff to handle transient failures.
- **Idempotent Wrappers**: Creating idempotent wrappers around non-idempotent operations to ensure consistency.
- **Transactional Boundaries**: Defining transactional boundaries to ensure all-or-nothing behavior for sequences of operations.

## 7. Anti-Patterns
Describe common but discouraged practices.
Anti-patterns for handling non-idempotent actions include:
- **Ignoring Concurrency**: Failing to account for concurrent access to shared resources.
- **Inadequate Error Handling**: Not implementing robust error detection, reporting, and recovery mechanisms.
- **Over-Reliance on Locks**: Relying excessively on locking mechanisms, which can lead to performance bottlenecks and deadlocks.

## 8. References
Provide exactly five authoritative external references.
1. [IEEE Computer Society - Transactional Memory](https://www.computer.org/web/transactions-on-parallel-and-distributed-systems)
2. [ACM Queue - The Problem with Threads](https://queue.acm.org/detail.cfm?id=2489236)
3. [Microsoft Azure - Idempotent Operations](https://docs.microsoft.com/en-us/azure/architecture/patterns/idempotent)
4. [Google Cloud - Handling Non-Idempotent Requests](https://cloud.google.com/apis/design/non-idempotent)
5. [W3C - Web Architecture: Idempotent Methods](https://www.w3.org/2001/tag/doc/whenToUseGet.html#idempotentMethods)

## 9. Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-23 | Initial documentation |